<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DemoShop - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º —Å–µ—Ä–≤–∏—Å–æ–º</title>
    <style>
        .product-card {
            background: white;
            padding: 20px;
            margin: 10px;
            border-radius: 10px;
            display:inline-block;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .buy-button {
            background: #4CAF50;
            color: white;
            padding: 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        .buy-button:hover { background: #45a049; }
        .container{ text-align: center; padding: 20px; }
        .success-page {
            background: #d4edda;
            padding: 30px;
            margin: 20px;
            border-radius: 10px;
            border: 1px solid #c3e6cb;
        }
        .success-title { color: #155724; font-size: 24px; }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ -->
        <div id="mainPage">
            <h1>üõçÔ∏è DemoShop</h1>
            
            <div class="products">
                <div class="product-card">
                    <div class="product-title">–°–º–∞—Ä—Ç—Ñ–æ–Ω Premium - 25 000 ‚ÇΩ</div>
                    <button class="buy-button" onclick="redirectToPayment(25000, '–°–º–∞—Ä—Ç—Ñ–æ–Ω Premium')">
                        –ö—É–ø–∏—Ç—å —Å–µ–π—á–∞—Å
                    </button>
                </div>
                
                <div class="product-card">
                    <div class="product-title">–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ - 8 500 ‚ÇΩ</div>
                    <button class="buy-button" onclick="redirectToPayment(8500, '–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏')">
                        –ö—É–ø–∏—Ç—å —Å–µ–π—á–∞—Å
                    </button>
                </div>

                <div class="product-card">
                    <div class="product-title">–ò–≥—Ä–æ–≤–æ–π –Ω–æ—É—Ç–±—É–∫ ASUS - 77 999 ‚ÇΩ</div>
                    <button class="buy-button" onclick="redirectToPayment(77999, '–ò–≥—Ä–æ–≤–æ–π –Ω–æ—É—Ç–±—É–∫ ASUS')">
                        –ö—É–ø–∏—Ç—å —Å–µ–π—á–∞—Å
                    </button>
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã -->
        <div id="successPage" style="display: none;">
            <div class="success-page">
                <h1 class="success-title">‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!</h1>
                <div id="paymentDetails"></div>
                <button class="buy-button" onclick="goToMainPage()">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø–æ–∫—É–ø–∫–∞–º</button>
            </div>
        </div>
    </div>

    <script>
        // –ü–†–û–°–¢–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–ï–†–ï–ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø –ù–ê –ü–õ–ê–¢–ï–ñ–ù–£–Æ –§–û–†–ú–£
        function redirectToPayment(amount, product) {
            const orderId = 'ORDER-' + Date.now();
            const currentUrl = window.location.href.split('?')[0];
            
            const paymentUrl = 
                `http://localhost:8080/payment-form/demo?` +
                `amount=${amount}&` +
                `product=${encodeURIComponent(product)}&` +
                `order_id=${orderId}&` +
                `return_url=${encodeURIComponent(currentUrl)}`;
            
            console.log('üéØ URL –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞:', paymentUrl);
            console.log('üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:');
            console.log('  - amount:', amount);
            console.log('  - product:', product);
            console.log('  - order_id:', orderId);
            console.log('  - return_url:', currentUrl);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º
            if (!paymentUrl.includes('amount=') || !paymentUrl.includes('product=')) {
                console.error('‚ùå –û–®–ò–ë–ö–ê: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ URL!');
                return;
            }
            
            window.location.href = paymentUrl;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ø–µ—Ö–∞
        function showSuccessPage(paymentData) {
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('successPage').style.display = 'block';
            
            document.getElementById('paymentDetails').innerHTML = `
                <h3>–î–µ—Ç–∞–ª–∏ –ø–ª–∞—Ç–µ–∂–∞:</h3>
                <p><strong>–¢–æ–≤–∞—Ä:</strong> ${paymentData.product}</p>
                <p><strong>–°—É–º–º–∞:</strong> ${paymentData.amount} ‚ÇΩ</p>
                <p><strong>ID –æ–ø–µ—Ä–∞—Ü–∏–∏:</strong> ${paymentData.operation_id}</p>
                <p><strong>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞:</strong> ${paymentData.order_id}</p>
                <p><strong>–í—Ä–µ–º—è:</strong> ${new Date().toLocaleString()}</p>
            `;
        }

        // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
        function goToMainPage() {
            // –û—á–∏—â–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL
            window.location.href = window.location.origin + window.location.pathname;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (–¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–∑ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Ñ–æ—Ä–º—ã)
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            
            console.log('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL:', Object.fromEntries(urlParams.entries()));
            
            if (urlParams.get('payment_status') === 'success') {
                showSuccessPage({
                    product: urlParams.get('product'),
                    amount: urlParams.get('amount'),
                    operation_id: urlParams.get('operation_id'),
                    order_id: urlParams.get('order_id')
                });
            }
        });
    </script>
</body>
</html>